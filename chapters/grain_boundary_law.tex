% Sample file on how to use subfiles.
\documentclass[generate_interface_elements.tex]{subfiles}

\begin{document}

\chapter{Grain boundary traction separation law}

From Martin we have these curves calculated with LAMPS that show the grain boundary blah blah. Figure f√∂r shear och normal vid lite olika temperaturer / hastigheter.



The finite element analysis software Abaqus, used in this thesis, has support for \textit{cohesive elements}. In the manual for Abaqus it says that these "are primarily intended for bonded interfaces where the interface thickness is negligibly small.". In this thesis these cohesive elements are used to model the grain boundary law calculated in the atomic simulations.

The difference between cohesive elements and normal elements are that cohesive elements are not supposed to model any material but instead they are supposed to model the actual interface between two materials. The state of the element does not contain a stress tensor like in normal elements but instead a vector of the traction components, the normal traction $t_n$ and two shear tractions $t_s$ and $t_t$. The normal direction is defined from the node numbering of the element. An illustration of this can be seen in figure \ref{fig:cohs_ori}. The corresponding separations are denoted by $\delta_n, \delta_s, \delta_t$. The nominal strain in the element are defined as
%
\[ \epsilon_n = \frac{\delta_n}{T_0}, \quad \epsilon_s = \frac{\delta_s}{T_0}, \quad \epsilon_t = \frac{\delta_t}{T_0}  \]
%
The $T_0$ here is not the thickness of the cohesive element but a constitutive thickness that when put to 1.0 makes the strain and the separation equal. For a more detailed description of the how the constitutive thickness works see section 31.5.6 in the Abaqus manual.




\begin{figure}
\centering
 \includegraphics[width=.4\linewidth]{./figures/cohs_ele}
\caption{Orientation of a cohesive element. The order of the nodes is used to determine the bottom and top face as well as the positive normal direction. In order for the normal direction to point upwards the nodes should be given in a counter clockwise direction.}
\label{fig:cohs_ori}
\end{figure}


When modeling damage and failure of a material using cohesive element there are three main \textbf{things} that need to be defined:

\begin{enumerate}
\item The properties of the material before damage has taken place. Abaqus only has support for a a linear elastic traction-separation law prior to damage. This is however what the atomic simulations have shown so this is not a limitation in this case.

\item The criteria that defines when the material is said to start to experience damage. This is called the \textit{damage initiation criteria}.

\item The properties of the material after the damage initiation criteria has been fulfilled need to be prescribed. This is called the \textit{damage evolution}, it describes how the degradation of the material stiffness is changing as the material is experience more and more damage.
\end{enumerate}
%
A possible scenario for the damage initiation and evolution can be seen in figure \ref{fig:tract_sep}.



\begin{figure}
\centering
  \includegraphics[width=.6\linewidth]{./figures/tract_sep}
\caption{An example of a traction separation law. The point $a$ is the damage initation point where the stiffness of the material start to degrade. The damage evolution is the interval covered at $b$ showing how the damage is evolving with increasing separation. In this figure a linear damage evolution. At the separation point $\delta_n^t$ the material is at a complete failure and a fracture has occurred.}
\label{fig:tract_sep}
\end{figure}

\section{Undamaged behavior}
 
 The behaviour of the material before damage is assumed to be elastic and is written in term of a constitutive matrix as
 
 \[ \vec{t} = 
 \left[
\begin{array}{c c c}
t_n\\
t_s\\
t_t \\
\end{array} \right]
=
\left[
\begin{array}{c c c}
K_{nn} & K_{nt} & K_{ns} \\
K_{tn} & K_{tt} & K_{ts} \\
K_{sn} & K_{st} & K_{ss} \\
\end{array} \right]
 \left[
\begin{array}{c c c}
\epsilon_n\\
\epsilon_s\\
\epsilon_t \\
\end{array} \right]
= \vec{K} \vec{\epsilon}.
\]

As can be seen from the matrix coupled behaviour of all components are supported. However, since we only have experimental data for pure shear and normal strains only the diagonal elements will be non zero in this analysis. There is also no difference between the shear directions which means $K_{tt} = K_{ss}$. From the atomistic simulations we can see that $K_{nn} = XXX$ and $K_{tt} = XXX$.

 
 

\section{Damage initiation}

The damage initiation criteria is the point when the degradation of the material starts to occur. This can either be described as a function of the strain or the traction. There are two possible functions that can be used, one is based on the maximum strain or traction component and one is based on length of the strain or traction vector. For the traction criteria these functions can be expressed as

\[ \max \left( \frac{\langle t_n \rangle}{t_n^0} ,\frac{ t_s }{t_s^0} ,  \frac{ t_t }{t_t^0}  \right) = 1,  \] 

\[  \left( \frac{\langle t_n \rangle}{t_n^0} \right)^2 +   \left( \frac{ t_s }{t_s^0} \right)^2 +   \left( \frac{ t_t }{t_t^0} \right)^2 = 1.   \]	
%
Here $t_n^2, t_s^0, t_t^0$ are three user defined parameters. The symbol $\langle \rangle$ denotes the Macaulay brackets which is non zero only if the quantity inside the bracket is positive. This has the effect that pure compressions (negative tractions) do not lead to any damage. The functions for the strains are found by trivial modifications to the above functions. In the analysis used in this thesis the quadratic strain criteria is used. From the atomic simulations in figure XXX we can identify $\epsilon_n^0 = XXX$ and $\epsilon_t = \epsilon_s = XXX$.

\section{Damage evolution}

The damage evolution describes the rate of the degradation of the material based on the separation. The current degradation of the material is completely captured in one scalar $D$. The tractions are then calculated as 
%
\[ \vec{t} = (1 - D) \overline{\vec{t \]
%
 where $\overline{\vec{t}}$ is the traction in the element that would have occurred if there was no damage in the material. Before the damage initiation criteria has been fulfilled $D = 0$. This is one major limitation to the cohesive elements. By having the damage completely described with a single scalar it is hard to capture the difference in the traction separation law for normal and shear separations that the atomic simulations has shown exist. It would be useful if the damage in the material could be described by a three component vector or even more generally by a tensor. This is likely possible by writing a user made material where one codes how the traction is calculated from the separations (known in Abaqus as a \texttt{UMAT}) but doing this out of scope for this thesis.




From the software we can get get the a measure of how much of the traction is from the normal and shearing component. This measure is in form of a number $\phi_1$ between 0 and 1 that is defined as

begin{align} \phi_1 = \frac{2}{\pi} \arctan \left( \frac{ \sqrt{t_s^2 + t_t^2}}{\langle t_n \rangle} \right) & \Rightarrow \\
   \underbrace{\tan\left( \phi_1\frac{ \pi}{2} \right)}_{P} \langle t_n \rangle =  \sqrt{t_s^2 + t_t^2} & \Rightarrow \\
 P^2\langle K_{nn} \d_n \rangle^2 = K_{tt}^2 \left( \d_s^2 + \d_t^2 \right)
\end{align}

This together with 
\[ d = \sqrt{d_n^2 + d_s^2 + d_t^2}  \]
means we can solve for $d_n$ and $\sqrt{d_s^2 + d_t^2}$ in terms of $\phi_1$ and $d$.

The result is 
\[ d_n = \frac{d}{\sqrt{\left(\frac{PK_{nn}}{K_{tt}}\right)^2 + 1 }  } \]
\[ \sqrt{d_t^2 + d_s^2} = d\sqrt{1 -\frac{1}{\left(\frac{PK_{nn}}{K_{tt}} \right)^2 + 1 } \]

We now calculate two different damage scalars, $D_n$ which is the damage from the pure . The total damage


$ D = 1 - (1 - D_n)(1 - D_t). $

This is similar to how Abaqus calculates total damage from different damage from multiple criteria, see section 23.2.3 in the Abaqus manual.


Using this method would give the traction separation laws as in figure \ref{fig:mixed_tract_sep} for different $\phi_1$.

\begin{figure}
\centering
  \includegraphics[width=.6\linewidth]{./figures/mixed_tract_sep}
\caption{The resulting traction for different $\phi_1$. The limiting cases of pure shear and pure normal displacement is shown in blue. It can be seen that the earliest fracture possible is in the case of pure normal separation which is expected. }
\label{fig:mixed_tract_sep}
\end{figure}


Since the faces of the grains are meshed with triangles it 


The way these cohesive elements are inserted into the mesh output from Neper is as follows. 

Every face is shared by two grains. The nodes in a face are duplicated twice and all the elements from the first grain that have nodes in the face are reconnected to the first batch of the duplicated nodes.  The same is done for the elements in the second grain but these elements are connected to the second batch of new nodes. The grains that was previously sharing a face now have two separate faces that do not share any nodes. The two new faces are then connected to each other using six node cohesive wedge elements. This is repeated for all faces in the microstructure. An example of the insertion of these cohesive elements between two grains can be seen in figure \ref{fig:cohs_2}. The grains have for clarity of the figure been separated. In the start of an actual analysis the cohesive element have no width.
\begin{figure}
\centering
\begin{subfigure}[b]{.4\textwidth}
  \centering
  \includegraphics[width=.4\linewidth]{./figures/2_cohs}
  \caption{}
  \label{fig:cohs_2_a}
\end{subfigure}%
\hspace{-10mm}
\begin{subfigure}[b]{.4\textwidth}
  \centering
  \includegraphics[width=.4\linewidth]{./figures/2_grain_no_cohs}
  \caption{}
  \label{fig:cohs_2_b}
\end{subfigure}%
\hspace{-10mm}
\begin{subfigure}[b]{.4\textwidth}
  \centering
  \includegraphics[width=.4\linewidth]{./figures/2_grain_cohs}
  \caption{}
  \label{fig:cohs_2_c}
\end{subfigure}
\caption{Insertion of cohesive elements between two grains. (a) The two grains. (b) Duplication of nodes in the face. Grains have been separated for clarity of the figure. (c) Cohesive elements inserted. }
\label{fig:cohs_2}
\end{figure}




Since we want to do calculation in the general strain case but only have access to the boundary cases of pure shear and pure normal strain some sort of interpolation is needed. The method that has been used is described here.

 

The traction is calculated by $K \epsilon = t$ where $K$ in general is the matrix



\begin{figure}
\centering
\begin{subfigure}[b]{.5\textwidth}
  \centering
  \includegraphics[width=.5\linewidth]{./figures/cohs_with_poly}
  \caption{Course structured mesh.}
  \label{fig:pois_voronoi_struct_a}
\end{subfigure}%
\begin{subfigure}[b]{.5\textwidth}
  \centering
  \includegraphics[width=.5\linewidth]{./figures/cohs_without_poly}
  \caption{More refined structured mesh.}
  \label{fig:pois_voronoi_struct_b}
\end{subfigure}
\caption{Structured mesh of different coarseness.}
\label{fig:pois_voronoi_struct}
\end{figure}


\end{document}